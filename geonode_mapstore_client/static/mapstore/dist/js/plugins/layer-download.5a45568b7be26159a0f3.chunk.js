/*! For license information please see layer-download.5a45568b7be26159a0f3.chunk.js.LICENSE.txt */
(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[2426],{95797:(e,t,r)=>{"use strict";r.d(t,{DR:()=>n,S0:()=>o,u7:()=>a,lj:()=>i,yz:()=>l,lN:()=>u,zW:()=>s,Yx:()=>c,VN:()=>p,Hu:()=>d,VT:()=>f,RD:()=>m,Qq:()=>y,R1:()=>b,_T:()=>v,vO:()=>g,XO:()=>h,jG:()=>O,Xc:()=>w,gT:()=>E,rG:()=>S,t3:()=>R,Fs:()=>P,w_:()=>A,Lm:()=>D,rh:()=>j,rP:()=>x,IO:()=>T}),r(75875);var n="LAYER_SELECTED_FOR_SEARCH",o="FEATURE_TYPE_SELECTED",a="FEATURE_TYPE_LOADED",i="FEATURE_LOADED",l="FEATURE_LOADING",u="FEATURE_TYPE_ERROR",s="FEATURE_ERROR",c="QUERY_CREATE",p="QUERY:UPDATE_QUERY",d="QUERY_RESULT",f="QUERY_ERROR",m="RESET_QUERY",y="QUERY",b="INIT_QUERY_PANEL",v="QUERY:TOGGLE_SYNC_WMS",g="QUERY:TOGGLE_LAYER_FILTER";function h(){return{type:v}}function O(){return{type:g}}function w(){return{type:b}}function E(e,t){return{type:o,url:e,typeName:t}}function S(e,t){return{type:a,typeName:e,featureType:t}}function R(e,t){return{type:u,typeName:e,error:t}}function P(e){return{type:l,isLoading:e}}function A(e,t,r,n,o){return{type:d,searchUrl:t,filterObj:r,result:e,queryOptions:n,reason:o}}function D(e){return{type:f,error:e}}function j(e,t){return{type:p,updates:e,reason:t}}function x(e,t){return{type:c,searchUrl:e,filterObj:t}}function T(e,t,r,n){return{type:y,searchUrl:e,filterObj:t,queryOptions:r,reason:n}}},7472:(e,t,r)=>{"use strict";r.d(t,{Z:()=>P});var n=r(27418),o=r.n(n),a=r(45697),i=r.n(a),l=r(67294),u=r.n(l),s=r(85294),c=r.n(s),p=r(72986),d=r.n(p),f=r(5346);function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return w(e)}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(l,e);var t,r,n,a,i=(n=l,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=E(n);if(a){var r=E(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return O(this,e)});function l(){var e;v(this,l);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return S(w(e=i.call.apply(i,[this].concat(r))),"renderLoading",(function(){return e.props.maskLoading?u().createElement("div",{style:{width:"100%",height:"100%",position:"absolute",overflow:"visible",margin:"auto",verticalAlign:"center",left:"0",background:"rgba(255, 255, 255, 0.5)",zIndex:2}},u().createElement("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -40%)"}},u().createElement(f.Z,{msgId:"loading"}),u().createElement(d(),{spinnerName:"circle",noFadeIn:!0,overrideSpinnerClassName:"spinner"}))):null})),S(w(e),"renderRole",(function(t){return u().Children.toArray(e.props.children).filter((function(e){return e.props.role===t}))})),S(w(e),"hasRole",(function(t){return u().Children.toArray(e.props.children).filter((function(e){return e.props.role===t})).length>0})),S(w(e),"onClickOut",(function(t){e.props.onClickOut&&e.mask===t.target&&e.props.onClickOut(t)})),e}return t=l,(r=[{key:"render",value:function(){var e=this,t=u().createElement("div",{id:this.props.id,style:b({zIndex:3},this.props.style),className:"".concat(this.props.draggable?"modal-dialog-draggable":""," ").concat(this.props.className," modal-dialog-container")},u().createElement("div",{className:this.props.headerClassName+" draggable-header"},this.renderRole("header")),u().createElement("div",{className:this.props.bodyClassName},this.renderLoading(),this.renderRole("body")),this.hasRole("footer")?u().createElement("div",{className:this.props.footerClassName},this.renderRole("footer")):u().createElement("span",null)),r=this.props.draggable?u().createElement(c(),{defaultPosition:this.props.start,bounds:this.props.bounds,handle:".draggable-header, .draggable-header *"},t):t,n=o()({},this.props.style.display?{display:this.props.style.display}:{},this.props.backgroundStyle);return this.props.modal?u().createElement("div",{ref:function(t){e.mask=t},onClick:this.onClickOut,style:n,className:"fade in modal "+this.props.containerClassName,role:"dialog"},r):r}}])&&g(t.prototype,r),l}(u().Component);S(R,"propTypes",{id:i().string.isRequired,style:i().object,backgroundStyle:i().object,className:i().string,maskLoading:i().bool,containerClassName:i().string,headerClassName:i().string,bodyClassName:i().string,footerClassName:i().string,onClickOut:i().func,modal:i().bool,start:i().object,draggable:i().bool,bounds:i().oneOfType([i().string,i().object])}),S(R,"defaultProps",{style:{},backgroundStyle:{background:"rgba(0,0,0,.5)"},start:{x:0,y:150},className:"modal-dialog modal-content",maskLoading:!1,containerClassName:"",headerClassName:"modal-header",bodyClassName:"modal-body",footerClassName:"modal-footer",modal:!1,draggable:!0,bounds:"parent"});const P=R},35400:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(67294),o=r.n(n),a=r(14471);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.style,r=void 0===t?{}:t,n=e.mainViewStyle,i=void 0===n?{}:n,u=e.contentStyle,s=void 0===u?{}:u,c=e.imageStyle,p=void 0===c?{}:c,d=e.glyph,f=void 0===d?"info-sign":d,m=e.iconFit,y=e.title,b=e.tooltip,v=e.tooltipId,g=e.description,h=e.content;return o().createElement("div",{className:"empty-state-container",style:l({height:m?"100%":void 0},r)},o().createElement("div",{key:"main-view",className:"empty-state-main-view",style:l({height:m?"100%":void 0},i)},f?o().createElement("div",{key:"glyph",className:"empty-state-image",style:l({height:m?"100%":void 0},p)},o().createElement(a.Z,{iconFit:m,tooltip:b,tooltipId:v,glyph:f})):null,y?o().createElement("h1",{key:"title"},y):null,g?o().createElement("p",{key:"description",className:"empty-state-description"},g):null),o().createElement("div",{key:"content",className:"empty-state-content",style:s},h))}},14471:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var n=r(67294),o=r.n(n),a=r(57588),i=r(96259),l=(0,r(15135).Z)(a.Glyphicon);const u=function(e){var t=e.glyph,r=void 0===t?"info-sign":t,n=e.tooltip,a=e.tooltipId,u=e.iconFit,s=e.padding,c=void 0===s?0:s,p=e.margin,d=void 0===p?0:p;return o().createElement(i.Z,null,(function(e){var t=e.width,i=e.height;return o().createElement(l,{glyph:r,tooltip:n,tooltipId:a,style:{display:"inline-block",padding:c+"px",margin:d+"px",textAlign:"center",fontSize:u?Math.min(t,i)-2*c-2*d:t-2*c-2*d}})}))}},99534:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(61365),o=r(69334);const a=(0,n.Z)(o.h_)},82030:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(67294),o=r.n(n),a=r(23560),i=r.n(a),l=r(2479),u=r(35400);const s=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u.Z;return(0,l.branch)(e,(function(){return function(e){return o().createElement(r,t&&i()(t)?t(e):t)}}))}},45869:(e,t,r)=>{"use strict";r.d(t,{Z:()=>y});var n=r(67294),o=r.n(n),a=r(45697),i=r.n(a);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(l,e);var t,r,n,a,i=(n=l,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(n);if(a){var r=d(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return p(this,e)});function l(){return u(this,l),i.apply(this,arguments)}return t=l,(r=[{key:"render",value:function(){var e=this;return o().createElement("label",{className:"mapstore-switch-btn ".concat(this.props.className)},o().createElement("input",{type:"checkbox",disabled:this.props.disabled,checked:this.props.checked,onChange:function(){return e.props.onChange(!e.props.checked)}}),o().createElement("span",{onClick:function(){return e.props.onClick(!e.props.checked)},className:"m-slider"}))}}])&&s(t.prototype,r),l}(o().Component);f(m,"propTypes",{disabled:i().bool,className:i().string,checked:i().bool,onChange:i().func,onClick:i().func}),f(m,"defaultProps",{className:"",checked:!1,onChange:function(){},onClick:function(){}});const y=m},72747:(e,t,r)=>{"use strict";r.d(t,{l:()=>u});var n=r(89255),o=r(75875),a=r.n(o),i=r(10284),l=r(99767),u=function(e,t){return n.Observable.defer((function(){return a().get((0,l.Jy)(e,{version:"1.0.0",REQUEST:"DescribeProcess",IDENTIFIER:t}),{timeout:5e3,headers:{Accept:"application/json","Content-Type":"application/xml"}})})).let(i.oB)}},80658:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>cr});var n={};r.r(n),r.d(n,{checkExportDataEntriesEpic:()=>tr,checkWPSAvailabilityEpic:()=>Ht,closeExportDownload:()=>$t,fetchFormatsWFSDownload:()=>Qt,openDownloadTool:()=>Kt,resetExportDataResultsOnLogout:()=>nr,serializeCookieOnExportDataChange:()=>rr,setExportDataResultsOnLoginSuccessAndMapConfigLoaded:()=>or,showInfoBubbleMessageEpic:()=>er,startFeatureExportDownload:()=>Jt});var o=r(33664),a=r(22222),i="LAYERDOWNLOAD:CHECK_WPS_AVAILABILITY",l="LAYERDOWNLOAD:CHECKING_WPS_AVAILABILITY",u="LAYERDOWNLOAD:DOWNLOAD_FEATURES",s="LAYERDOWNLOAD:DOWNLOAD_FINISHED",c="LAYERDOWNLOAD:FORMAT_SELECTED",p="LAYERDOWNLOAD:CLEAR_DOWNLOAD_OPTIONS",d="LAYERDOWNLOAD:FORMAT_FETCH",f="LAYERDOWNLOAD:FORMAT_UPDATE",m="LAYERDOWNLOAD:SET_SERVICE",y="LAYERDOWNLOAD:SET_EXPORT_DATA_RESULTS",b="LAYERDOWNLOAD:ADD_EXPORT_DATA_RESULT",v="LAYERDOWNLOAD:UPDATE_EXPORT_DATA_RESULT",g="LAYERDOWNLOAD:REMOVE_EXPORT_DATA_RESULT",h="LAYERDOWNLOAD:REMOVE_EXPORT_DATA_RESULTS",O="LAYERDOWNLOAD:CHECK_EXPORT_DATA_ENTRIES",w="LAYERDOWNLOAD:CHECKING_EXPORT_DATA_ENTRIES",E="LAYERDOWNLOAD:SERIALIZE_COOKIE",S="LAYERDOWNLOAD:SHOW_INFO_BUBBLE_MESSAGE",R="LAYERDOWNLOAD:SHOW_INFO_BUBBLE",P="LAYERDOWNLOAD:SET_INFO_BUBBLE_MESSAGE",A=function(e){return{type:l,checking:e}},D=function(e,t){return{type:c,key:e,value:t}},j=function(){return{type:s}},x=function(e){return{type:m,service:e}},T=function(e){return{type:y,results:e}},C=function(e,t){return{type:v,id:e,newProps:t}},N=function(e){return{type:w,checking:e}},F=function(e,t,r,n){return{type:S,msgId:e,msgParams:t,level:r,duration:n}},I=function(e){return{type:R,show:e}},L=function(e,t,r){return{type:P,msgId:e,msgParams:t,level:r}},k=r(82904),_=r(31255),G=r(75110),M=r(24260),q=function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.service},U=(0,a.P1)(_.Rd,M.X1,G.Iz,(function(e,t,r){return e?t:null!=r&&r.name?{featureTypeName:r.name,filterType:"OGC",ogcVersion:"1.1.0"}:null})),W=function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.results},B=r(8316),Z=r(67294),Y=r.n(Z),X=r(45697),V=r.n(X),z=r(30998),H=r.n(z),K=r(27418),Q=r.n(K),J=r(57588),$=r(72986),ee=r.n($),te=r(32425),re=r(7472),ne=r(99534),oe=r(5346),ae=r(35400),ie=r(43129),le=r(27361),ue=r.n(le),se=r(91175),ce=r.n(se),pe=r(47037),de=r.n(pe),fe=r(45869);function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}const ye=function(e){var t,r,n=e.cropDataSetVisible,o=void 0!==n&&n,a=e.cropDataSetEnabled,i=void 0!==a&&a,l=e.donwloadFilteredVisible,u=void 0!==l&&l,s=e.downloadFilteredEnabled,c=void 0!==s&&s,p=e.advancedOptionsVisible,d=void 0!==p&&p,f=e.compressionOptions,m=void 0===f?["CCITT RLE","LZW","JPEG","ZLib","PackBits","Deflate"]:f,y=e.selectedCompression,b=e.tileWidth,v=e.tileHeight,g=e.quality,h=e.onChange,O=void 0===h?function(){}:h,w=(t=Y().useState(!1),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,l=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){l=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(l)throw o}}return a}}(t,r)||function(e,t){if(e){if("string"==typeof e)return me(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?me(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),E=w[0],S=w[1];return Y().createElement(Y().Fragment,null,o&&Y().createElement("div",{className:"mapstore-downloadwpsoptions-menuitem"},Y().createElement(fe.Z,{checked:i,onClick:function(e){return O("cropDataSet",e)}}),Y().createElement(oe.Z,{msgId:"layerdownload.cropDataSet"})),u&&Y().createElement("div",{className:"mapstore-downloadwpsoptions-menuitem"},Y().createElement(fe.Z,{checked:c,onClick:function(e){return O("downloadFilteredDataSet",e)}}),Y().createElement(oe.Z,{msgId:"layerdownload.downloadFilteredDataSet"})),d&&Y().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-options"},Y().createElement(J.Button,{className:"no-border",onClick:function(){return S(!E)}},Y().createElement(J.Glyphicon,{glyph:"chevron-".concat(E?"down":"right")})),Y().createElement(oe.Z,{msgId:"layerdownload.advancedOptions"})),E&&d&&Y().createElement("div",{className:"mapstore-downloadwpsoptions-advanced"},Y().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},Y().createElement(oe.Z,{msgId:"layerdownload.compression"}),Y().createElement(ie.ZP,{clearable:!0,value:y,options:m.map((function(e){return de()(e)?{value:e,label:e}:e})),onChange:function(e){return O("compression",null==e?void 0:e.value)}})),Y().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},Y().createElement(oe.Z,{msgId:"layerdownload.quality"}),Y().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},Y().createElement(J.FormControl,{placeholder:"0.75",type:"number",min:"0",max:"1",value:g||"",onChange:function(e){return O("quality",e.target.value)}}))),Y().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},Y().createElement(oe.Z,{msgId:"layerdownload.tileWidth"}),Y().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},Y().createElement(J.FormControl,{placeholder:"256",type:"number",min:"0",value:b||"",onChange:function(e){return O("tileWidth",e.target.value&&e.target.value.length>0?"".concat(parseInt(e.target.value,10)):"")}}),Y().createElement("span",null,"px"))),Y().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},Y().createElement(oe.Z,{msgId:"layerdownload.tileHeight"}),Y().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},Y().createElement(J.FormControl,{placeholder:"256",type:"number",min:"0",value:v||"",onChange:function(e){return O("tileHeight",e.target.value&&e.target.value.length>0?"".concat(parseInt(e.target.value,10)):"")}}),Y().createElement("span",null,"px")))))};function be(e){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ge(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function he(e,t){return(he=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Oe(e,t){if(t&&("object"===be(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return we(e)}function we(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ee(e){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Se(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&he(e,t)}(i,e);var t,r,n,o,a=(n=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ee(n);if(o){var r=Ee(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Oe(this,e)});function i(){var e;ve(this,i);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Se(we(e=a.call.apply(a,[this].concat(r))),"getSelectedFormat",(function(){return ue()(e.props,"downloadOptions.selectedFormat")})),Se(we(e),"getSelectedSRS",(function(){return ue()(e.props,"downloadOptions.selectedSrs")||e.props.defaultSrs||ue()(ce()(e.props.srsList),"name")})),e}return t=i,(r=[{key:"render",value:function(){var e,t=this;return Y().createElement("form",null,Y().createElement("label",null,Y().createElement(oe.Z,{msgId:"layerdownload.format"})),Y().createElement(ie.ZP,{clearable:!1,isLoading:this.props.formatsLoading,onOpen:function(){return t.props.formatOptionsFetch(t.props.layer)},value:null===(e=this.props.downloadOptions)||void 0===e?void 0:e.selectedFormat,noResultsText:Y().createElement(oe.Z,{msgId:"layerdownload.format"}),onChange:function(e){return t.props.onChange("selectedFormat",e.value)},options:this.props.formats.map((function(e){return{value:e.name,label:e.label||e.name}}))}),Y().createElement("label",null,Y().createElement(oe.Z,{msgId:"layerdownload.srs"})),Y().createElement(ie.ZP,{clearable:!1,value:this.getSelectedSRS(),onChange:function(e){return t.props.onChange("selectedSrs",e.value)},options:this.props.srsList.map((function(e){return{value:e.name,label:e.label||e.name}}))}),this.props.wpsOptionsVisible&&Y().createElement(ye,{cropDataSetVisible:!0,donwloadFilteredVisible:this.props.downloadFilteredVisible,advancedOptionsVisible:this.props.wpsAdvancedOptionsVisible,cropDataSetEnabled:this.props.downloadOptions.cropDataSet,downloadFilteredEnabled:this.props.downloadOptions.downloadFilteredDataSet,selectedCompression:this.props.downloadOptions.compression,quality:this.props.downloadOptions.quality,tileWidth:this.props.downloadOptions.tileWidth,tileHeight:this.props.downloadOptions.tileHeight,onChange:this.props.onChange}),this.props.virtualScroll?null:Y().createElement(J.Checkbox,{checked:this.props.downloadOptions.singlePage,onChange:function(){return t.props.onChange("singlePage",!t.props.downloadOptions.singlePage)}},Y().createElement(oe.Z,{msgId:"layerdownload.downloadonlycurrentpage"})))}}])&&ge(t.prototype,r),i}(Y().Component);Se(Re,"propTypes",{downloadOptions:V().object,formatOptionsFetch:V().func,formats:V().array,srsList:V().array,onChange:V().func,defaultSrs:V().string,wpsOptionsVisible:V().bool,wpsAdvancedOptionsVisible:V().bool,downloadFilteredVisible:V().bool,layer:V().object,formatsLoading:V().bool,virtualScroll:V().bool}),Se(Re,"defaultProps",{downloadOptions:{},formatsLoading:!1,formats:[],srsList:[],wpsOptionsVisible:!1,wpsAdvancedOptionsVisible:!1,downloadFilteredVisible:!1,virtualScroll:!0});const Pe=Re;var Ae=r(82467);function De(e){return(De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function je(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Te(e,t){return(Te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ce(e,t){if(t&&("object"===De(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ne(e)}function Ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fe(e){return(Fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ie(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Le=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Te(e,t)}(i,e);var t,r,n,o,a=(n=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Fe(n);if(o){var r=Fe(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Ce(this,e)});function i(){var e;je(this,i);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Ie(Ne(e=a.call.apply(a,[this].concat(r))),"onClose",(function(){e.props.onClose()})),Ie(Ne(e),"renderIcon",(function(){return e.props.loading?Y().createElement("div",{style:{float:"left"}},Y().createElement(ee(),{spinnerName:"circle",noFadeIn:!0})):Y().createElement(J.Glyphicon,{glyph:"download"})})),Ie(Ne(e),"handleExport",(function(){var t=e.props,r=t.url,n=t.filterObj,o=t.downloadOptions,a=t.defaultSrs,i=t.srsList,l=t.onExport,u=t.layer,s=o&&o.selectedSrs||a||(i[0]||{}).name;l(r||u.url,n,Q()({},o,{selectedSrs:s}))})),e}return t=i,(r=[{key:"componentDidMount",value:function(){this.props.onMount()}},{key:"componentWillUnmount",value:function(){this.props.onUnmount()}},{key:"componentDidUpdate",value:function(e){this.props.enabled!==e.enabled&&this.props.enabled&&(this.props.onClearDownloadOptions(),"wms"===this.props.layer.type&&this.props.onCheckWPSAvailability(this.props.url||this.props.layer.url))}},{key:"render",value:function(){var e,t,r,n=this,o=function(e){return n.props.formats.filter((function(t){var r,o,a=t.validServices,i=t.type,l=void 0===i?"vector":i;return(!a||H()(a,(function(t){return t===e}))>-1)&&("vector"===l&&(null===(r=n.props.layer.search)||void 0===r?void 0:r.url)||"raster"===l&&!(null!==(o=n.props.layer.search)&&void 0!==o&&o.url))}))},a=o("wfs"),i=o("wps"),l=a.length>0?a.filter((function(e){return n.props.wfsFormats.find((function(t){return t.name.toLowerCase()===e.name.toLowerCase()}))})):this.props.wfsFormats;return this.props.enabled?Y().createElement(ne.Z,null,Y().createElement(re.Z,{id:"mapstore-export",draggable:!1,modal:!0},Y().createElement("span",{role:"header"},Y().createElement("span",{className:"about-panel-title"},Y().createElement(oe.Z,{msgId:"layerdownload.title"})),Y().createElement("button",{onClick:this.onClose,className:"settings-panel-close close"},this.props.closeGlyph?Y().createElement(J.Glyphicon,{glyph:this.props.closeGlyph}):Y().createElement("span",null,"×"))),Y().createElement("div",{role:"body"},this.props.checkingWPSAvailability?Y().createElement(te.Z,{size:100,style:{margin:"0 auto"}}):"wfs"!==this.props.service||null!==(e=this.props.layer.search)&&void 0!==e&&e.url?Y().createElement(Pe,{downloadOptions:this.props.downloadOptions,onChange:this.props.onDownloadOptionChange,formatOptionsFetch:"wfs"===this.props.service?this.props.onFormatOptionsFetch:function(){},formatsLoading:this.props.formatsLoading,formats:"wfs"===this.props.service?l:i,srsList:this.props.srsList,defaultSrs:this.props.defaultSrs,wpsOptionsVisible:"wps"===this.props.service,wpsAdvancedOptionsVisible:!(null!==(t=this.props.layer.search)&&void 0!==t&&t.url),downloadFilteredVisible:!(null===(r=this.props.layer.search)||void 0===r||!r.url),layer:this.props.layer,virtualScroll:this.props.virtualScroll}):Y().createElement(ae.Z,{title:Y().createElement(oe.Z,{msgId:"layerdownload.noSupportedServiceFound"})})),!this.props.checkingWPSAvailability&&Y().createElement("div",{role:"footer"},Y().createElement(Ae.Z,{bsStyle:"primary",className:"download-button",disabled:!this.props.downloadOptions.selectedFormat||this.props.loading,onClick:this.handleExport},this.renderIcon()," ",Y().createElement(oe.Z,{msgId:"layerdownload.export"}))))):null}}])&&xe(t.prototype,r),i}(Y().Component);Ie(Le,"propTypes",{filterObj:V().object,closeGlyph:V().string,url:V().string,service:V().string,onMount:V().func,onUnmount:V().func,enabled:V().bool,loading:V().bool,checkingWPSAvailability:V().bool,onClose:V().func,onExport:V().func,onCheckWPSAvailability:V().func,onDownloadOptionChange:V().func,onClearDownloadOptions:V().func,onFormatOptionsFetch:V().func,downloadOptions:V().object,wfsFormats:V().array,formats:V().array,srsList:V().array,defaultSrs:V().string,layer:V().object,formatsLoading:V().bool,virtualScroll:V().bool}),Ie(Le,"defaultProps",{onMount:function(){},onUnmount:function(){},onExport:function(){},onClose:function(){},onCheckWPSAvailability:function(){},onDownloadOptionChange:function(){},onClearDownloadOptions:function(){},onFormatOptionsFetch:function(){},checkingWPSAvailability:!1,layer:{},closeGlyph:"1-close",service:"wfs",wfsFormats:[],formats:[{name:"application/json",label:"GeoJSON",type:"vector",validServices:["wps"]},{name:"application/arcgrid",label:"ArcGrid",type:"raster",validServices:["wps"]},{name:"image/tiff",label:"TIFF",type:"raster",validServices:["wps"]},{name:"image/png",label:"PNG",type:"raster",validServices:["wps"]},{name:"image/jpeg",label:"JPEG",type:"raster",validServices:["wps"]},{name:"application/wfs-collection-1.0",label:"wfs-collection-1.0",type:"vector",validServices:["wps"]},{name:"application/wfs-collection-1.1",label:"wfs-collection-1.1",type:"vector",validServices:["wps"]},{name:"application/zip",label:"Shapefile",type:"vector",validServices:["wps"]},{name:"text/csv",label:"CSV",type:"vector",validServices:["wps"]}],formatsLoading:!1,srsList:[{name:"native",label:"Native"},{name:"EPSG:4326",label:"WGS84"}],virtualScroll:!0,downloadOptions:{}});const ke=Le;var _e=r(82030),Ge=r(50966),Me=r(24262),qe=Y().createElement(J.Button,{bsStyle:"primary",bsSize:"small",className:"mapstore-exportdataresults-item-failed"},Y().createElement(J.Glyphicon,{glyph:"exclamation-sign"}));const Ue=(0,_e.Z)((function(e){var t=e.results;return!(void 0===t?[]:t).length}),{title:Y().createElement(oe.Z,{msgId:"exportDataResults.emptyStateMessage"})})((function(e){var t=e.loading,r=void 0!==t&&t,n=e.results,o=void 0===n?[]:n,a=e.currentLocale,i=e.onRemoveResult,l=void 0===i?function(){}:i;return r?Y().createElement(te.Z,{size:100,style:{margin:"0 auto",padding:"10px"}}):Y().createElement("div",{className:"mapstore-exportdataresults-container"},o.map((function(e){var t=e.id,r=e.layerName,n=e.layerTitle,o=e.startTime,i=e.status,u=e.result,s=(0,Me.in)({name:r,title:n},a),c=new Date(o),p=function(e){return e<10?"0".concat(e):"".concat(e)},d="".concat(p(c.getDate()),"/").concat(p(c.getMonth()+1),"/").concat(c.getFullYear()," ").concat(p(c.getHours()),":").concat(p(c.getMinutes()));return Y().createElement("div",{key:t,className:"mapstore-exportdataresults-item"},Y().createElement("div",{className:"mapstore-exportdataresults-item-name"},s),Y().createElement("div",{className:"mapstore-exportdataresults-item-date"},d),Y().createElement("div",{className:"mapstore-exportdataresults-item-buttons"},"pending"===i&&Y().createElement(te.Z,{size:22,style:{marginLeft:"2px"}}),"failed"===i&&u&&u.msgId?Y().createElement(Ge.Z,{placement:"top",overlay:Y().createElement(J.Tooltip,{id:"exportresults-failure-tooltip"},Y().createElement(oe.Z,{msgId:u.msgId,msgParams:u.msgParams}))},qe):null,"failed"!==i||u&&u.msgId?null:qe,"completed"===i&&Y().createElement("a",{href:u},Y().createElement(J.Button,{bsStyle:"primary",bsSize:"small"},Y().createElement(J.Glyphicon,{glyph:"floppy-disk"}))),Y().createElement(J.Button,{bsStyle:"primary",bsSize:"small",onClick:function(){return l(t)}},Y().createElement(J.Glyphicon,{glyph:"trash"}))))})))}));var We=r(94184),Be=r.n(We);function Ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}const Ye=function(e){var t,r=e.show,n=e.arrowDirection,o=void 0===n?"bottom":n,a=e.className,i=e.containerClassName,l=e.children;return Y().createElement("div",{className:Be().apply(void 0,["mapstore-info-bubble"].concat((t=r?["mapstore-info-bubble-visible"]:[],function(e){if(Array.isArray(e))return Ze(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return Ze(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ze(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[a]))},Y().createElement("div",{className:Be()("mapstore-info-bubble-container",i)},Y().createElement("div",{className:Be()("mapstore-info-bubble-arrow-container","arrow-".concat(o))},Y().createElement("div",{className:"mapstore-info-bubble-arrow"})),Y().createElement("div",{className:"mapstore-info-bubble-inner"},l)))},Xe=function(e){var t=e.msgId,r=e.msgParams,n=e.level,o=void 0===n?"normal":n,a=e.className;return Y().createElement("div",{className:Be()("mapstore-info-bubble-default-inner","mapstore-info-bubble-default-inner-level-".concat(o),a)},t?Y().createElement(oe.Z,{msgId:t,msgParams:r}):null)};var Ve=r(9669),ze=r.n(Ve),He=r(89255),Ke=r(13311),Qe=r.n(Ke),Je=r(78718),$e=r.n(Je),et=r(93220),tt=r.n(et),rt=r(78598),nt=r(5055),ot=r(7526),at=r(23570),it=r.n(at),lt=r(75982),ut=r(80416),st=r(95797),ct=r(97395),pt=r(63516),dt=r(81808),ft=r(7147),mt=r(827),yt=r(74621),bt=r(86850),vt=r(72747),gt=r(3674),ht=r.n(gt),Ot=r(57557),wt=r.n(Ot),Et=r(99767),St=r(27835);function Rt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Pt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Rt(Object(r),!0).forEach((function(t){At(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function At(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dt(e){return function(e){if(Array.isArray(e))return xt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||jt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jt(e,t){if(e){if("string"==typeof e)return xt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?xt(e,t):void 0}}function xt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Tt=function(e){var t=e.type,r=e.data;return"TEXT"===t?(0,Et.XA)((0,Et.p5)((0,Et.Rr)(r.data),r.mimeType)):(0,Et.fA)(r.mimeType,r.href,r.method,(0,Et.Rr)(r.requestBodyData))},Ct=function(e,t,r){if(e&&t){var n=(0,St.mG)(e,(i=(a={layerName:t.layerName,ROI:t.ROI,roiCRS:t.roiCRS,dataFilter:t.dataFilter,targetCRS:t.targetCRS}).layerName,l=a.ROI,u=a.roiCRS,s=a.dataFilter,c=a.targetCRS,(0,St.Uh)("gs:DownloadEstimator",[(0,Et.qP)("layerName",(0,Et.XA)((0,Et.gN)(i)))].concat(Dt(l?[(0,Et.qP)("ROI",Tt(l))]:[]),Dt(u?[(0,Et.qP)("RoiCRS",(0,Et.XA)((0,Et.gN)(u)))]:[]),Dt(s?[(0,Et.qP)("filter",Tt(s))]:[]),Dt(c?[(0,Et.qP)("targetCRS",(0,Et.XA)((0,Et.gN)(c)))]:[])))),{outputsExtractor:(0,St.dr)(St.ai)}),o=(0,St.mG)(e,function(e){var t=e.layerName,r=e.dataFilter,n=e.outputFormat,o=e.targetCRS,a=e.roiCRS,i=e.ROI,l=e.cropToROI,u=e.asynchronous,s=e.outputAsReference,c=e.resultOutput,p=e.writeParameters;return(0,St.Uh)("gs:Download",[(0,Et.qP)("layerName",(0,Et.XA)((0,Et.gN)(t))),(0,Et.qP)("outputFormat",(0,Et.XA)((0,Et.gN)(n)))].concat(Dt(i?[(0,Et.qP)("ROI",Tt(i))]:[]),Dt(r?[(0,Et.qP)("filter",Tt(r))]:[]),Dt(o?[(0,Et.qP)("targetCRS",(0,Et.XA)((0,Et.gN)(o)))]:[]),Dt(a?[(0,Et.qP)("RoiCRS",(0,Et.XA)((0,Et.gN)(a)))]:[]),[(0,Et.qP)("cropToROI",(0,Et.XA)((0,Et.gN)(l?"true":"false")))],Dt(p&&ht()(p).length>0?[(0,Et.XJ)(tt()(p).map((function(e){var t,r,n=(r=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,l=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){l=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(l)throw o}}return a}}(t,r)||jt(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],a=n[1];return(0,Et.Dx)(o,a)})).join(""))]:[])),(0,Et.DK)(u?(0,Et.Tr)(!0,!0,s?(0,Et.t$)(c,!0,"result"):(0,Et.En)("result",c)):(0,Et.En)("result",c)))}(Pt(Pt({},wt()(t,"notifyDownloadEstimatorSuccess")),{},{outputAsReference:!!t.asynchronous&&t.outputAsReference})),r,{headers:{"Content-Type":"application/xml",Accept:"application/xml, ".concat(t.resultOutput||"application/zip")}});return n.catch((function(){throw new Error("DownloadEstimatorException")})).mergeMap((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(e.length>0&&"result"===e[0].identifier&&"true"===e[0].data)return t.notifyDownloadEstimatorSuccess?He.Observable.of("DownloadEstimatorSuccess").concat(o):o;throw new Error("DownloadEstimatorFailed")}))}var a,i,l,u,s,c;return He.Observable.empty()},Nt=r(63202),Ft=r(47805),It=[{outputFormat:"shape-zip",extension:"zip"},{outputFormat:"csv",extension:"csv"},{outputFormat:"excel",extension:"xls"},{outputFormat:"excel2007",extension:"xlsx"},{outputFormat:"dxf",extension:"dxf"},{outputFormat:"dxf-zip",extension:"zip"},{outputFormat:"application/vnd.google-earth.kml+xml",extension:"kml"},{outputFormat:"application/json",extension:"json"},{outputFormat:"gml3",extension:"gml"},{outputFormat:"GML2",extension:"gml"},{outputFormat:"application/vnd.googlxml",extension:"kml"},{outputFormat:"OGR-CSV",extension:"csv"},{outputFormat:"OGR-FileGDB",extension:"gdb"},{outputFormat:"OGR-GPKG",extension:"gpkg"},{outputFormat:"OGR-KML",extension:"kml"},{outputFormat:"OGR-MIF",extension:"mif"},{outputFormat:"OGR-TAB",extension:"tab"},{outputFormat:"SHAPE-ZIP",extension:"zip"},{outputFormat:"gml32",extension:"gml"},{outputFormat:"application/x-gpk",extension:"gpk"}],Lt=r(86267),kt=r(10284);function _t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Gt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(r),!0).forEach((function(t){Mt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Mt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qt(e){return function(e){if(Array.isArray(e))return Wt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Ut(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ut(e,t){if(e){if("string"==typeof e)return Wt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Wt(e,t):void 0}}function Wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Bt={gml3:"GML3.1",GML2:"GML2","DXF-ZIP":"DXF-ZIP","application/vnd.google-earth.kml+xml":"KML","OGR-CSV":"OGR-CSV","OGR-FileGDB":"OGR-GeoDatabase","OGR-GPKG":"OGR-GeoPackage","OGR-KML":"OGR-KML","OGR-MIF":"OGR-MIF","OGR-TAB":"OGR-TAB","SHAPE-ZIP":"Shapefile",gml32:"GML3.2","application/json":"GeoJSON",csv:"CSV","application/x-gpkg":"GeoPackage",excel:"excel",excel2007:"excel2007"},Zt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.filterObj,n=void 0===r?{}:r,o=e.downloadOptions,a=void 0===o?{}:o,i=(0,Ft.toOGCFilter)(n.featureTypeName,n,n.ogcVersion,n.sortOptions,!1,null,null,a.selectedSrs);return He.Observable.defer((function(){return ze().post((0,Nt.$F)(t+"?service=WFS&outputFormat=".concat(a.selectedFormat)),i,{timeout:6e4,responseType:"arraybuffer",headers:{"Content-Type":"application/xml"}})}))},Yt=function(e){var t,r=ue()(e,"filterObj.featureTypeName"),n=(t=ue()(e,"downloadOptions.selectedFormat"),ce()(It.filter((function(e){return e.outputFormat===t})))||function(e){var t=e.split(/[^\w]/)[1];return t?{outputFormat:e,extension:t.toLowerCase()}:void 0}(t));return n&&n.extension?r+"."+n.extension:r},Xt=function(e){return e.query&&e.query.featureTypes&&e.query.featureTypes[e.query.typeName]&&e.query.featureTypes[e.query.typeName].attributes&&e.query.featureTypes[e.query.typeName].attributes[0]&&e.query.featureTypes[e.query.typeName].attributes[0].attribute||null},Vt=function(e){switch(e.code){case"ProcessFailed":return{msgId:"layerdownload.wpsExecuteError.processFailed",msgParams:{exceptionReport:e.message}};case"NoStatusLocation":case"NoExecutionId":case"UnexpectedProcessStatus":return{msgId:"layerdownload.wpsExecuteError.badResponse",msgParams:{eCode:e.code}};case"ExecuteProcessXHRFailed":return{msgId:"layerdownload.wpsExecuteError.executeProcessXhrFailed"};case"GetExecutionStatusXHRFailed":return{msgId:"layerdonwload.wpsExecuteError.getExecutionStatusXhrFailed"};default:return{msgId:"layerdownload.wpsExecuteError.unexpectedError"}}},zt=function(e){var t=(0,yt.np)(e);if(null!=t&&t.id){var r=document.cookie.split(";").filter((function(e){return e.indexOf("exportDataResults_".concat(t.id,"="))>-1}))[0];if(r){var n=JSON.parse(decodeURIComponent(r.split("=")[1])).results;return He.Observable.of(T(n.filter((function(e){return"pending"!==e.status}))))}}return He.Observable.empty()},Ht=function(e){return e.ofType(i).switchMap((function(e){var t=e.url;return(0,vt.l)(t,"gs:DownloadEstimator,gs:Download").switchMap((function(e){return He.Observable.defer((function(){return new Promise((function(t,r){return(0,nt.parseString)(e.data,{tagNameProcessors:[ot.stripPrefix]},(function(e,n){return e?r(e):t(n)}))}))}))})).flatMap((function(e){var t,r,n,o,a,i,l,u,s=[null==e||null===(t=e.ProcessDescriptions)||void 0===t||null===(r=t.ProcessDescription)||void 0===r||null===(n=r[0])||void 0===n||null===(o=n.Identifier)||void 0===o?void 0:o[0],null==e||null===(a=e.ProcessDescriptions)||void 0===a||null===(i=a.ProcessDescription)||void 0===i||null===(l=i[1])||void 0===l||null===(u=l.Identifier)||void 0===u?void 0:u[0]];return He.Observable.of(x(H()(s,(function(e){return"gs:DownloadEstimator"===e}))>-1&&H()(s,(function(e){return"gs:Download"===e}))>-1?"wps":"wfs"),A(!1))})).catch((function(){return He.Observable.of(x("wfs"),A(!1))})).startWith(A(!0))}))},Kt=function(e){return e.ofType(ut.HN).switchMap((function(e){var t;return He.Observable.from([(0,k.Xi)("layerdownload"),D("singlePage",!1)].concat(qt(null!==(t=e.layer.search)&&void 0!==t&&t.url?[(0,st.rP)(e.layer.url,{featureTypeName:e.layer.name})]:[])))}))},Qt=function(e){return e.ofType(d).switchMap((function(e){return(0,bt.ED)(e).map((function(e){return t=function(e){var t=ue()(e,"WFS_Capabilities.OperationsMetadata.Operation"),r=Qe()(t,(function(e){return"GetFeature"===e.name})),n=ue()(r,"Parameter"),o=Qe()(n,(function(e){return"outputFormat"===e.name})).Value,a=$e()(Bt,o);return tt()(a).map((function(e){var t,r,n=(r=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,l=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){l=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(l)throw o}}return a}}(t,r)||Ut(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return{name:n[0],label:n[1]}}))}(e),{type:f,wfsFormats:t};var t}))}))},Jt=function(e,t){return e.ofType(u).switchMap((function(r){var n,o,a,i,l=t.getState(),u=(l.featuregrid||{}).virtualScroll,s=void 0!==u&&u,c=q(l),p=(0,G.Iz)(l),d=(0,mt.pQ)(l),f=(0,B.Pz)(l);return"wps"===c?(n=r.downloadOptions.cropDataSet&&!!d&&!!d.bounds,o={layerName:p.name,outputFormat:r.downloadOptions.selectedFormat,asynchronous:!0,outputAsReference:!0,targetCRS:r.downloadOptions.selectedSrs&&"native"!==r.downloadOptions.selectedSrs?r.downloadOptions.selectedSrs:void 0,cropToROI:n,dataFilter:r.downloadOptions.downloadFilteredDataSet?{type:"TEXT",data:{mimeType:"text/plain; subtype=filter/1.0",data:(0,Ft.mergeFiltersToOGC)({ogcVersion:"1.0.0",addXmlnsToRoot:!0,xmlnsToAdd:['xmlns:ogc="http://www.opengis.net/ogc"','xmlns:gml="http://www.opengis.net/gml"']},p.layerFilter,r.filterObj)}}:void 0,ROI:n?{type:"TEXT",data:{mimeType:"application/json",data:JSON.stringify((0,Lt.bboxToFeatureGeometry)(d.bounds))}}:void 0,roiCRS:n?d.crs||"EPSG:4326":void 0,writeParameters:Gt(Gt(Gt({},r.downloadOptions.tileWidth?{tilewidth:r.downloadOptions.tileWidth}:{}),r.downloadOptions.tileHeight?{tileheight:r.downloadOptions.tileHeight}:{}),r.downloadOptions.compression?Gt({compression:r.downloadOptions.compression},r.downloadOptions.quality?{quality:r.downloadOptions.quality}:{}):{}),notifyDownloadEstimatorSuccess:!0},a={id:it()(),layerName:p.name,layerTitle:p.title,status:"pending"},i={outputsExtractor:(0,St.dr)(St.RW)},Ct(r.url,o,i).takeUntil(e.ofType(g).filter((function(e){return e.id===a.id})).take(1)).flatMap((function(e){var t,r;return"DownloadEstimatorSuccess"===e?He.Observable.of((r=Gt(Gt({},a),{},{startTime:(new Date).getTime()}),{type:b,result:r}),F("layerdownload.exportResultsMessages.newExport"),j(),(0,k.Xi)("layerdownload","enabled")):(t=He.Observable).of.apply(t,qt(e&&e.length>0&&e[0].href?[C(a.id,{status:"completed",result:e[0].href}),F("layerdownload.exportResultsMessages.exportSuccess",{layerTitle:(0,Me.in)(p,f)},"success")]:[C(a.id,{status:"failed",result:{msgId:"layerdonwload.exportResultsMessages.invalidHref"}}),F("layerdownload.exportResultsMessages.exportFailure",{layerTitle:(0,Me.in)(p,f)},"danger")]))})).catch((function(e){var t;return(t=He.Observable).of.apply(t,qt(e.message&&e.message.indexOf("DownloadEstimator")>-1?[(0,ct.vU)({error:e,title:"layerdownload.error.downloadEstimatorTitle",message:"layerdownload.error.downloadEstimatorFailed"}),j()]:[C(a.id,{status:"failed",result:Vt(e)}),F("layerdownload.exportResultsMessages.exportFailure",{layerTitle:(0,Me.in)(p,f)},"danger")]))}))):Zt({url:r.url,downloadOptions:r.downloadOptions,filterObj:Gt(Gt({},r.filterObj),{},{pagination:!s&&ue()(r,"downloadOptions.singlePage")?r.filterObj&&r.filterObj.pagination:null})}).do((function(e){var t=e.data;if("application/xml"===e.headers["content-type"]){var r=String.fromCharCode.apply(null,new Uint8Array(t));if(0===r.indexOf("<ows:ExceptionReport"))throw r}})).catch((function(){return Zt({url:r.url,downloadOptions:r.downloadOptions,filterObj:Gt(Gt({},r.filterObj),{},{pagination:!s&&ue()(r,"downloadOptions.singlePage")?r.filterObj&&r.filterObj.pagination:null,sortOptions:(e=Xt(t.getState()),e?{sortBy:e,sortOrder:"A"}:{})})}).do((function(e){var t=e.data,n=e.headers;if("application/xml"===n["content-type"]){var o=String.fromCharCode.apply(null,new Uint8Array(t));if(0===o.indexOf("<ows:ExceptionReport"))throw o}(0,rt.saveAs)(new Blob([t],{type:n&&n["content-type"]}),Yt(r))}));var e})).do((function(e){var t=e.data,n=e.headers;(0,rt.saveAs)(new Blob([t],{type:n&&n["content-type"]}),Yt(r))})).map((function(){return j()})).catch((function(e){return He.Observable.of((0,ct.vU)({error:e,title:"layerdownload.error.title",message:"layerdownload.error.invalidOutputFormat",autoDismiss:5,position:"tr"}),j())}))}))},$t=function(e,t){return e.ofType(k.kM).filter((function(e){return"queryPanel"===e.control&&!(0,ft._d)(t.getState())&&(0,ft.lI)(t.getState())})).switchMap((function(){return He.Observable.of((0,k.Xi)("layerdownload"))}))},er=function(e){return e.ofType(S).concatMap((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return He.Observable.of(L(e.msgId,e.msgParams,e.level),I(!0)).delay(10).concat(He.Observable.of(I(!1)).delay(e.duration||3e3)).concat(He.Observable.empty().delay(1e3))}))},tr=function(e,t){return e.ofType(O).exhaustMap((function(){var e=t.getState(),r=(W(e)||[]).filter((function(e){return"completed"===e.status}));return r.length>0?He.Observable.forkJoin(r.map((function(e){var t=e.result,r=t.indexOf("executionId="),n=t.slice(r),o=n.indexOf("&"),a=(o>-1?n.slice(0,o):n).slice(12),i=t.indexOf("?"),l=t.slice(0,i);return(0,St.W5)(l,a).let(kt.oB).catch((function(){return He.Observable.of(null)})).map((function(t){return t?null:e.id}))}))).flatMap((function(e){return He.Observable.of((t=e.filter((function(e){return!!e})),{type:h,ids:t}),{type:E},N(!1));var t})).startWith(N(!0)):He.Observable.empty()}))},rr=function(e,t){return e.ofType(b,g,v,E).filter((function(){return(0,yt.jl)(t.getState())})).do((function(){var e=t.getState(),r=W(e),n=(0,yt.np)(e).id,o=JSON.stringify({results:r});document.cookie="exportDataResults_".concat(n,"=").concat(encodeURIComponent(o))})).flatMap((function(){return He.Observable.empty()}))},nr=function(e){return e.ofType(dt.ok).switchMap((function(){return e.ofType(pt.Nv).switchMap((function(){return He.Observable.of(T([]))})).takeUntil(e.ofType(lt.nk))}))},or=function(e,t){return e.ofType(dt.ok).switchMap((function(){return zt(t.getState()).concat(e.ofType(pt.XP).switchMap((function(){return zt(t.getState())})).takeUntil(e.ofType(lt.nk)))}))};function ar(e){return function(e){if(Array.isArray(e))return ir(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ir(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ir(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ir(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ur(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?lr(Object(r),!0).forEach((function(t){sr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function sr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const cr=(0,r(22843).rx)("LayerDownload",{component:(0,o.connect)((0,a.zB)({url:M.Bu,filterObj:U,enabled:function(e){var t,r;return null==e||null===(t=e.controls)||void 0===t||null===(r=t.layerdownload)||void 0===r?void 0:r.enabled},downloadOptions:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.downloadOptions},loading:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.loading},wfsFormats:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.wfsFormats},formatsLoading:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.formatsLoading},layer:G.Iz,service:q,checkingWPSAvailability:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.checkingWPSAvailability},virtualScroll:function(e){return e&&e.featuregrid&&e.featuregrid.virtualScroll}}),{onExport:function(e,t,r){return{type:u,url:e,filterObj:t,downloadOptions:r}},onDownloadOptionChange:D,onClearDownloadOptions:function(){return{type:p}},onFormatOptionsFetch:function(e){return{type:d,layer:e}},onCheckWPSAvailability:function(e){return{type:i,url:e}},onMount:function(){return(0,k.Xg)("layerdownload","available",!0)},onUnmount:function(){return(0,k.Xg)("layerdownload","available",!1)},onClose:function(){return(0,k.Xi)("layerdownload")}})(ke),containers:{TOC:{doNotHide:!0,name:"LayerDownload"},MapFooter:{name:"LayerDownload",position:1,tool:(0,o.connect)((0,a.zB)({active:function(e){var t,r;return null==e||null===(t=e.controls)||void 0===t||null===(r=t.exportDataResults)||void 0===r?void 0:r.enabled},showInfoBubble:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.showInfoBubble},infoBubbleMessage:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.infoBubbleMessage},checkingExportDataEntries:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.checkingExportDataEntries},results:W,currentLocale:B.Pz}),{onToggle:k.Xi.bind(null,"exportDataResults","enabled"),onActive:function(){return{type:O}},onRemoveResult:function(e){return{type:g,id:e}}})((function(e){var t=e.active,r=void 0!==t&&t,n=e.showInfoBubble,o=void 0!==n&&n,a=e.infoBubbleMessage,i=void 0===a?{}:a,l=e.checkingExportDataEntries,u=e.results,s=void 0===u?[]:u,c=e.currentLocale,p=e.onToggle,d=void 0===p?function(){}:p,f=e.onActive,m=void 0===f?function(){}:f,y=e.onRemoveResult;return Y().useEffect((function(){r&&m()}),[r]),Y().createElement(Y().Fragment,null,s.length>0?Y().createElement("div",{id:"mapstore-export-data-results-button-container"},Y().createElement(Ge.Z,{placement:"left",overlay:Y().createElement(J.Tooltip,{id:"mapstore-export-data-results-tooltip"},Y().createElement(oe.Z,{msgId:"exportDataResults.title"}))},Y().createElement(J.Button,{bsStyle:"primary",bsSize:"small",onClick:function(){return d()}},Y().createElement(J.Glyphicon,{glyph:"download"}))),Y().createElement(Ye,{show:o,className:"mapstore-export"},Y().createElement(Xe,i))):null,Y().createElement("div",null,r&&Y().createElement(ne.Z,null,Y().createElement(re.Z,{id:"mapstore-export-data-results",draggable:!1,modal:!0},Y().createElement("span",{role:"header"},Y().createElement("span",{className:"about-panel-title"},Y().createElement(oe.Z,{msgId:"exportDataResults.title"})),Y().createElement("button",{onClick:function(){return d()},className:"settings-panel-close close"},Y().createElement(J.Glyphicon,{glyph:"1-close"}))),Y().createElement("div",{role:"body"},Y().createElement(Ue,{loading:l,results:s,currentLocale:c,onRemoveResult:y}))))))}))}},epics:n,reducers:{layerdownload:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{downloadOptions:{singlePage:!0}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u:return ur(ur({},e),{},{loading:!0});case c:return ur(ur({},e),{},{downloadOptions:ur(ur({},e.downloadOptions),{},sr({},t.key,t.value))});case p:return ur(ur({},e),{},{downloadOptions:{singlePage:!0}});case d:return ur(ur({},e),{},{layer:t.layer,wfsFormats:[],formatsLoading:!0});case s:return ur(ur({},e),{},{loading:!1});case f:return ur(ur({},e),{},{wfsFormats:t.wfsFormats,formatsLoading:!1});case m:return ur(ur({},e),{},{service:t.service});case l:return ur(ur({},e),{},{checkingWPSAvailability:t.checking});case y:return ur(ur({},e),{},{results:t.results});case b:return ur(ur({},e),{},{results:[].concat(ar(e.results||[]),[t.result])});case v:var r=H()(e.results||[],{id:t.id});return ur(ur({},e),{},{results:r>-1?[].concat(ar(e.results.slice(0,r)),[ur(ur({},e.results[r]),t.newProps||{})],ar(e.results.slice(r+1))):e.results});case g:return ur(ur({},e),{},{results:(e.results||[]).filter((function(e){return e.id!==t.id}))});case h:return ur(ur({},e),{},{results:(e.results||[]).filter((function(e){return-1===H()(t.ids,(function(t){return t===e.id}))}))});case R:return ur(ur({},e),{},{showInfoBubble:t.show});case P:return ur(ur({},e),{},{infoBubbleMessage:{msgId:t.msgId,msgParams:t.msgParams,level:t.level}});case w:return ur(ur({},e),{},{checkingExportDataEntries:t.checking});default:return e}}}})},7147:(e,t,r)=>{"use strict";r.d(t,{Yq:()=>a,Iz:()=>i,QF:()=>l,_d:()=>u,pn:()=>s,lI:()=>c,PJ:()=>p,dH:()=>d,Gd:()=>f,tL:()=>m,R4:()=>y,BP:()=>b});var n=r(27361),o=r.n(n),a=function(e){return function(e,t){return function(t){return o()(t,"controls[".concat(e,"][").concat("enabled","]"))}}(e)},i=function(e){return o()(e,"controls.measure.showCoordinateEditor")},l=function(e){return o()(e,"controls.measure.enabled")},u=function(e){return o()(e,"controls.queryPanel.enabled")},s=function(e){return!!o()(e,"controls.layerdownload.available")},c=function(e){return!!o()(e,"controls.layerdownload.enabled")},p=function(e){return o()(e,"controls.widgetBuilder.available",!1)},d=function(e){return o()(e,"controls.widgetBuilder.enabled")},f=function(e){return o()(e,"controls.layersettings.initialSettings")||{}},m=function(e){return o()(e,"controls.layersettings.originalSettings")||{}},y=function(e){return o()(e,"controls.layersettings.activeTab")||"general"},b=function(e){return o()(e,"controls.drawer.enabled",!1)}},31255:(e,t,r)=>{"use strict";r.d(t,{u$:()=>E,PI:()=>S,_w:()=>R,eO:()=>P,kG:()=>A,P3:()=>D,bq:()=>T,LB:()=>C,b4:()=>N,M0:()=>F,Li:()=>I,Rd:()=>L,g5:()=>k,Sj:()=>_,o:()=>G,eK:()=>M,jY:()=>q,ND:()=>U,OK:()=>W,tU:()=>B,ou:()=>Z,DK:()=>Y,Gl:()=>X,uz:()=>V,Ci:()=>z,Ae:()=>H,gz:()=>K,He:()=>Q,P4:()=>J,kd:()=>$,TC:()=>ee,nq:()=>te,Vf:()=>re});var n=r(91175),o=r.n(n),a=r(27361),i=r.n(a),l=r(13218),u=r.n(l),s=r(75110),c=r(78889),p=r(8316),d=r(52259),f=r(96958),m=r(85148),y=r(74621),b=r(93152),v=r(24260);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){O(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function O(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var w=s.CA,E=function(e){return i()(e,"featuregrid.selectedLayer")},S=function(e){return i()(e,"featuregrid.chartDisabled",!1)},R=function(e){return e&&e.featuregrid&&e.featuregrid.select},P=function(e){return e&&e.featuregrid&&e.featuregrid.changes},A=function(e){return e&&e.featuregrid&&e.featuregrid.newFeatures},D=function(e){return o()(R(e))},j=function(e){var t=(0,v.Qs)(e);if(t){var r=(0,c.findGeometryProperty)(t);return r&&r.localType}return null},x=["Geometry","GeometryCollection"],T=function(e){return!o()(x.filter((function(t){return j(e)===t})))},C=function(e){return P(e)&&P(e).length>0},N=function(e){return A(e)&&A(e).length>0},F=function(e){return e&&e.featuregrid&&e.featuregrid.filters},I=function(e){return w(e,E(e))},L=function(e){return e&&e.featuregrid&&e.featuregrid.open},k=function(e,t){return i()(F(e),t)},_=function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.title||e.name}(w(e,E(e)));return u()(t)?t[(0,p.Pz)(e)]||t.default||"":t},G=function(e){return((0,v.L)(e)||[]).map((function(t){var r=function(e,t){return i()(e,"featuregrid.attributes[".concat(t.name||t.attribute,"]"))}(e,t);return r?h(h({},t),r):t}))},M=function(e){return e&&e.featuregrid&&e.featuregrid.mode},q=function(e){return(R(e)||[]).length},U=function(e){return(0,f.rK)(P(e))},W=function(e){return function(e){var t=D(e);if(t){var r=(0,f.rK)(P(e));return!((!r[t.id]||null===r[t.id].geometry)&&(r[t.id]&&null===r[t.id].geometry||t._new&&o()(A(e))&&null===o()(A(e)).geometry||(!t._new||!o()(A(e))||null===o()(A(e)).geometry)&&null===t.geometry))}return!1}(e)},B=function(e){return i()(e,"featuregrid.showAgain",!1)},Z=function(e){if(i()(e,"featuregrid.showTimeSync",!1)){var t=E(e);return(0,m.jo)({id:t},"time")(e)}return null},Y=function(e){return i()(e,"featuregrid.timeSync",!1)},X=function(e){return i()(e,"featuregrid.showPopoverSync",!0)},V=function(e){return e&&e.featuregrid&&e.featuregrid.saving},z=function(e){return e&&e.featuregrid&&e.featuregrid.saved},H=function(e){return e&&e.featuregrid&&e.featuregrid.drawing},K=function(e){return i()(e,"featuregrid.multiselect",!1)},Q=function(e){return(0,d.isSimpleGeomType)(j(e))},J=function(e){return e.featuregrid&&e.featuregrid.dockSize},$=function(e){var t=w(e,E(e));return t&&t.name||""},ee=function(e){var t=function(e){return i()(w(e,E(e)),"params")}(e);return{viewParams:t&&(t.VIEWPARAMS||t.viewParams||t.viewparams),cqlFilter:t&&(t.CQL_FILTER||t.cqlFilter||t.cql_filter)}},te=function(e){var t=(0,y.L3)(e),r=function(e){return i()(e,"featuregrid.editingAllowedRoles",["ADMIN"])}(e)||["ADMIN"],n=function(e){return e&&e.featuregrid&&e.featuregrid.canEdit}(e);return(-1!==r.indexOf(t)||n)&&!(0,b.c0)(e)},re=function(e){return i()(e,"featuregrid.pagination")}},24260:(e,t,r)=>{"use strict";r.d(t,{qj:()=>g,Bu:()=>h,UM:()=>O,X1:()=>w,L:()=>E,HY:()=>S,Mz:()=>R,F0:()=>P,dc:()=>A,b0:()=>D,hk:()=>j,Qs:()=>x,gy:()=>T,M7:()=>C,VD:()=>N});var n=r(14293),o=r.n(n),a=r(27361),i=r.n(a),l=r(91175),u=r.n(l),s=r(1469),c=r.n(s),p=r(30998),d=r.n(p);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var b=function(e){return i()(e,"query.filterObj.featureTypeName")},v=function(e){return function(t){return i()(t,'query.featureTypes["'.concat(e,'"]'))}},g=function(e,t){return i()(v(t)(e),"original")},h=function(e){return e&&e.query&&e.query.searchUrl},O=function(e){return e&&e.query&&e.query.url},w=function(e){return e&&e.query&&e.query.filterObj},E=function(e){return i()(v(b(e))(e),"attributes")},S=function(e){return i()(e,"query.typeName")},R=function(e){return i()(e,"query.result.features")},P=function(e){var t=i()(e,"query.result");return m(m({},t),{},{features:(t&&t.features||[]).filter((function(e){return!o()(e.geometry)}))})},A=function(e,t){var r=e&&e.query&&e.query.result&&e.query.result.features;return u()(r.filter((function(e){return e.id===t})))},D={startIndex:function(e){return i()(e,"query.filterObj.pagination.startIndex")},maxFeatures:function(e){return i()(e,"query.filterObj.pagination.maxFeatures")},resultSize:function(e){return i()(e,"query.result.features.length")},totalFeatures:function(e){return i()(e,"query.result.totalFeatures")}},j=function(e,t){var r=v(t)(e);return!!(r&&r.attributes&&r.geometry&&r.original)},x=function(e){return g(e,b(e))},T=function(e){return i()(e,"query.featureLoading")},C=function(e){return i()(e,"query.syncWmsFilter",!1)},N=function(e){var t=i()(e,"query.filterObj.crossLayerFilter"),r=i()(e,"query.filterObj.spatialField"),n=i()(e,"query.filterObj.filterFields");return!!(n&&u()(n)||r&&(r.method&&r.operation&&r.geometry||c()(r)&&d()(r,(function(e){return e.method&&e.operation&&e.geometry}))>-1)||t&&t.collectGeometries&&t.operation)}},90874:(e,t,r)=>{"use strict";var n=r(95318);t.__esModule=!0,t.default=void 0;var o,a=n(r(50139)),i="clearTimeout",l=function(e){var t=(new Date).getTime(),r=Math.max(0,16-(t-s)),n=setTimeout(e,r);return s=t,n},u=function(e,t){return e+(e?t[0].toUpperCase()+t.substr(1):t)+"AnimationFrame"};a.default&&["","webkit","moz","o","ms"].some((function(e){var t=u(e,"request");if(t in window)return i=u(e,"cancel"),l=function(e){return window[t](e)}}));var s=(new Date).getTime();(o=function(e){return l(e)}).cancel=function(e){window[i]&&"function"==typeof window[i]&&window[i](e)};var c=o;t.default=c,e.exports=t.default},78598:function(e,t,r){var n,o=o||function(e){"use strict";if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,r=function(){return e.URL||e.webkitURL||e},n=t.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in n,a=/constructor/i.test(e.HTMLElement)||e.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent),l=function(t){(e.setImmediate||e.setTimeout)((function(){throw t}),0)},u=function(e){setTimeout((function(){"string"==typeof e?r().revokeObjectURL(e):e.remove()}),4e4)},s=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},c=function(t,c,p){p||(t=s(t));var d,f=this,m="application/octet-stream"===t.type,y=function(){!function(e,t,r){for(var n=(t=[].concat(t)).length;n--;){var o=e["on"+t[n]];if("function"==typeof o)try{o.call(e,e)}catch(e){l(e)}}}(f,"writestart progress write writeend".split(" "))};if(f.readyState=f.INIT,o)return d=r().createObjectURL(t),void setTimeout((function(){var e,t;n.href=d,n.download=c,e=n,t=new MouseEvent("click"),e.dispatchEvent(t),y(),u(d),f.readyState=f.DONE}));!function(){if((i||m&&a)&&e.FileReader){var n=new FileReader;return n.onloadend=function(){var t=i?n.result:n.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,f.readyState=f.DONE,y()},n.readAsDataURL(t),void(f.readyState=f.INIT)}d||(d=r().createObjectURL(t)),m?e.location.href=d:e.open(d,"_blank")||(e.location.href=d),f.readyState=f.DONE,y(),u(d)}()},p=c.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,r){return t=t||e.name||"download",r||(e=s(e)),navigator.msSaveOrOpenBlob(e,t)}:(p.abort=function(){},p.readyState=p.INIT=0,p.WRITING=1,p.DONE=2,p.error=p.onwritestart=p.onprogress=p.onwrite=p.onabort=p.onerror=p.onwriteend=null,function(e,t,r){return new c(e,t||e.name||"download",r)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);e.exports?e.exports.saveAs=o:null!==r.amdD&&null!==r.amdO&&(void 0===(n=function(){return o}.call(t,r,t,e))||(e.exports=n))},85082:(e,t,r)=>{var n=r(40554),o=r(88958);e.exports=function(e,t,r,a){var i=e.length;for((r=n(r))<0&&(r=-r>i?0:i+r),(a=void 0===a||a>i?i:n(a))<0&&(a+=i),a=r>a?0:o(a);r<a;)e[r++]=t;return e}},69877:e=>{var t=Math.floor,r=Math.random;e.exports=function(e,n){return e+t(r()*(n-e+1))}},48969:(e,t,r)=>{var n=r(29932);e.exports=function(e,t){return n(t,(function(t){return[t,e[t]]}))}},13866:(e,t,r)=>{var n=r(48969),o=r(64160),a=r(68776),i=r(99294);e.exports=function(e){return function(t){var r=o(t);return"[object Map]"==r?a(t):"[object Set]"==r?i(t):n(t,e(t))}}},99294:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=[e,e]})),r}},19873:(e,t,r)=>{var n=r(85082),o=r(16612);e.exports=function(e,t,r,a){var i=null==e?0:e.length;return i?(r&&"number"!=typeof r&&o(e,t,r)&&(r=0,a=i),n(e,t,r,a)):[]}},83608:(e,t,r)=>{var n=r(69877),o=r(16612),a=r(18601),i=parseFloat,l=Math.min,u=Math.random;e.exports=function(e,t,r){if(r&&"boolean"!=typeof r&&o(e,t,r)&&(t=r=void 0),void 0===r&&("boolean"==typeof t?(r=t,t=void 0):"boolean"==typeof e&&(r=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=a(e),void 0===t?(t=e,e=0):t=a(t)),e>t){var s=e;e=t,t=s}if(r||e%1||t%1){var c=u();return l(e+c*(t-e+i("1e-"+((c+"").length-1))),t)}return n(e,t)}},88958:(e,t,r)=>{var n=r(29750),o=r(40554);e.exports=function(e){return e?n(o(e),0,4294967295):0}},93220:(e,t,r)=>{var n=r(13866)(r(3674));e.exports=n}}]);