(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[8321],{31935:(t,e,r)=>{"use strict";r.d(e,{YL:()=>c,B0:()=>a,Mz:()=>s,TC:()=>l,qS:()=>f,Pe:()=>d,TP:()=>p});var n=r(22222),o=r(75110),u=r(93152),i=r(24262),c=function(t){return t.backgroundSelector&&t.backgroundSelector.source},a=function(t){return t.backgroundSelector&&t.backgroundSelector.modalParams},s=function(t){return t.backgroundSelector&&t.backgroundSelector.backgrounds||[]},l=function(t){return t.backgroundSelector&&t.backgroundSelector.lastRemovedId},f=function(t){return t.backgroundSelector&&t.backgroundSelector.confirmDeleteBackgroundModal},d=function(t){return t.backgroundSelector&&t.backgroundSelector.allowDeletion},p=(0,n.P1)(o.l2,u.$v,u.lh,(function(t,e,r){var n=t.filter((function(t){return t&&"background"===t.group}));return r&&r[e]?n.map((function(t){return(0,i.kf)(t,e)}))||[]:n}))},66113:(t,e,r)=>{"use strict";r.d(e,{$F:()=>w,eg:()=>D,Kg:()=>P,PR:()=>j,eK:()=>A,pu:()=>I,Lu:()=>R,W5:()=>k,TQ:()=>T,KR:()=>N,sY:()=>M,vv:()=>U,jq:()=>G,Tr:()=>z,w:()=>B,CK:()=>L,u5:()=>V,z7:()=>Y,FW:()=>F,GC:()=>x,yL:()=>W,_O:()=>$,JM:()=>H,bU:()=>q,mm:()=>X,X6:()=>Q,NR:()=>Z,I0:()=>J,eB:()=>tt,HB:()=>et});var n=r(27361),o=r.n(n),u=r(13311),i=r.n(u),c=r(30998),a=r.n(c),s=r(18446),l=r.n(s),f=r(44908),d=r.n(f),p=r(64721),b=r.n(p),y=r(92579),v=r(74621),g=r(24684);function m(t){return function(t){if(Array.isArray(t))return O(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return O(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function S(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function h(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?S(Object(r),!0).forEach((function(e){E(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function E(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var w=function(t){return function(e){return o()(e,(0,y.Ll)("geostory.currentStory.".concat(t),e),"")}},D=function(t){return o()(t,"geostory.isCollapsed",!1)},P=function(t){return o()(t,"geostory.currentStory")},j=function(t){return o()(t,"geostory.currentPage",{})},A=function(t){return o()(t,"geostory.mode")},I=function(t){return function(t){return o()(function(t){return o()(t,"geostory.resource")}(t),"canEdit",!1)}(t)||(0,v.qg)(t)},C=function(t){return o()(P(t),"sections",[])},R=function(t){return C(t).length>0},k=function(t){return o()(t,"geostory.isSettingsEnabled",!1)},T=function(t){var e=o()(P(t),"settings",{}),r=C(t).filter((function(t){var e=t.type;return b()([y.ID.CAROUSEL,y.ID.IMMERSIVE],e)})),n=e.checked||[],u=d()(n.map((function(t){return(0,y.Un)(r,t)})).filter((function(t){return t})));return h(h({},e),{},{expanded:u})},_=function(t){return o()(T(t),"checked",[]).reduce((function(t,e){return h(h({},t),{},E({},e,!0))}),{})},N=function(t){return!l()(o()(P(t),"settings",{}),function(t){return o()(t,"geostory.oldSettings",{})}(t))},M=function(t){return o()(t,"geostory.selectedCard","")},U=function(t){return function(e){return w("".concat(t,".resourceId"))(e)}},G=function(t){return o()(P(t),"resources",[])},z=function(t){return function(e){return i()(G(e),{id:t})}},B=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.withImmersiveSection,r=void 0!==e&&e,n=t.includeAlways,o=void 0===n||n;return function(t){var e=C(t),n=_(t);return e.reduce((function(t,e){if(e.type===y.ID.TITLE&&(o||n[e.id]))return[].concat(m(t),[e]);if(e.type===y.ID.PARAGRAPH&&(o||n[e.id]))return[].concat(m(t),[e]);if(e.type===y.ID.BANNER&&(o||n[e.id]))return[].concat(m(t),[e]);if(e.type===y.ID.CAROUSEL&&(o||n[e.id]))return[].concat(m(t),[e]);if(e.type===y.ID.IMMERSIVE){var u=e.contents&&e.contents.reduce((function(t,e){return o||n[e.id]?[].concat(m(t),[h(h({},e),{},{sectionId:t.id})]):t}),[])||[];return r?[].concat(m(t),[e],m(u)):[].concat(m(t),m(u))}return t}),[])}},L=function(t){return B({includeAlways:!0})(t).length},V=function(t){return a()(B({includeAlways:!0})(t),{id:j(t).columns&&j(t).columns[j(t).sectionId]?j(t).columns[j(t).sectionId]:j(t).sectionId||""})},Y=function(t){return void 0!==o()(t,"geostory.focusedContent.target")},F=function(t){return o()(t,"geostory.focusedContent")},x=function(t){return w(o()(t,"geostory.focusedContent.path",""))(t)},W=function(t){return C(t).reduce((function(t,e){if(b()([y.ID.IMMERSIVE,y.ID.CAROUSEL],e.type)){var r=e.contents&&e.contents.map((function(t){return{label:t.title||"",value:t.id}}))||[];return[].concat(m(t),[h({label:e.title||"",value:e.id},e.type===y.ID.IMMERSIVE&&{children:r})])}return[].concat(m(t),[{label:e.title||"",value:e.id}])}),[])},K=function t(e,r){var n=r.contents,o=r.background;return r.resourceId===e||!(!o||o.resourceId!==e)||!!n&&!!i()(n,(function(r){return t(e,r)}))},$=function(t,e){return!!i()(C(t),(function(t){return K(e,t)}))},H=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,g.F)(t).includes("geostory/shared")},q=function(t){return o()(t,"geostory.updateUrlOnScroll",!1)},X=function(t){return o()(t,"geostory.currentStory.settings.theme.fontFamilies",[])},Q=function(t){return o()(t,"geostory.mediaEditorSettings")},Z=function(t){var e;return((null===(e=P(t))||void 0===e?void 0:e.sections)||[]).filter((function(t){return t.type===y.ID.CAROUSEL}))},J=function(t){return function(e){return!!i()(Z(e),{id:t})}},tt=function(t){return function(e){var r=i()(Z(e)||[],{id:t});return(null==r?void 0:r.contents)||[]}},et=function(t){var e;return!(null==t||null===(e=t.geostory)||void 0===e||!e.drawOptions)}},58422:(t,e,r)=>{"use strict";r.d(e,{UC:()=>b}),r(52259),r(827);var n=r(22222),o=r(88113),u=r(1757),i=r(7877),c=r(85148),a=r(97291);function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){f(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function f(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r(75110),r(31935);var d={},p=(0,n.zB)({catalogServices:(0,n.zB)({services:o.b6,selectedService:o.Cb}),widgetsConfig:(0,n.zB)({widgets:u.zm,layouts:u.p,collapsed:u.lF}),mapInfoConfiguration:i.bI,dimensionData:(0,n.zB)({currentTime:c.WT,offsetTime:c.ns}),timelineData:(0,n.zB)({selectedLayer:a.Li})}),b=function(t){var e=Object.keys(d).reduce((function(e,r){return l(l({},e),{},f({},r,d[r](t)))}),{});return l(l({},p(t)),e)}},87218:(t,e,r)=>{"use strict";r.d(e,{I:()=>n,_:()=>o});var n=function(t){return t.searchconfig&&t.searchconfig.textSearchConfig},o=function(t){return t.searchbookmarkconfig&&t.searchbookmarkconfig.bookmarkSearchConfig}},74621:(t,e,r)=>{"use strict";r.d(e,{np:()=>n,L3:()=>o,jl:()=>u,y8:()=>i,qg:()=>c}),r(27418),r(27361);var n=function(t){return t&&t.security&&t.security.user},o=function(t){return n(t)&&n(t).role},u=function(t){return t&&t.security&&t.security.user},i=function(t){return t.security&&t.security.token},c=function(t){return"ADMIN"===o(t)}},73443:(t,e,r)=>{"use strict";r.d(e,{rs:()=>n,AY:()=>o,SW:()=>u,yB:()=>i,oG:()=>c,XG:()=>a,oz:()=>s,id:()=>l,gc:()=>f,cE:()=>d,rG:()=>p,Vj:()=>b,Pg:()=>y,nY:()=>v});var n="GEONODE:SAVING_RESOURCE",o="GEONODE:SAVE_SUCCESS",u="GEONODE:SAVE_ERROR",i="GEONODE:CLEAR_SAVE",c="GEONODE:SAVE_CONTENT",a="GEONODE:UPDATE_RESOURCE_BEFORE_SAVE",s="GEONODE:SAVE_DIRECT_CONTENT";function l(){return{type:n}}function f(t){return{type:o,success:t}}function d(t){return{type:u,error:t}}function p(){return{type:i}}function b(t,e,r,n){return{type:c,id:t,metadata:e,reload:r,showNotifications:n}}function y(t){return{type:a,id:t}}function v(){return{type:s}}},38334:(t,e,r)=>{"use strict";r.d(e,{oc:()=>n,v:()=>o,jo:()=>u,tv:()=>i,iF:()=>c,iC:()=>a});var n="GEONODE:START_ASYNC_PROCESS",o="GEONODE:STOP_ASYNC_PROCESS",u="GEONODE:UPDATE_ASYNC_PROCESS";function i(t){return{type:n,payload:t}}function c(t){return{type:u,payload:t}}function a(t){return{type:o,payload:t}}},18576:(t,e,r)=>{"use strict";r.d(e,{ZP:()=>U});var n,o=r(75875),u=r.n(o),i=r(49977),c=r(827),a=r(75110),s=r(31935),l=r(58422),f=r(87218),d=r(52259),p=r(63202),b=r(66113),y=r(1757),v=r(74621),g=r(97395),m=r(73443),O=r(43892),S=r(99380),h=r(55035),E=r(55877),w=r.n(E),D=r(3828),P=r(89514),j=r(38334),A=r(35721),I=r(12530);function C(t){return function(t){if(Array.isArray(t))return k(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||R(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(t,e){if(t){if("string"==typeof t)return k(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?k(t,e):void 0}}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function T(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function _(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?T(Object(r),!0).forEach((function(e){N(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function N(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var M=(N(n={},A.P6.MAP,(function(t,e,r,n){var o=(0,c.Od)(t)||{},u=(0,a.l2)(t),i=(0,a.Bt)(t),b=(0,s.Mz)(t),y=(0,f.I)(t),v=(0,f._)(t),g=(0,l.UC)(t),m=(0,d.saveMapConfiguration)(o,u,i,b,y,v,g),O={title:r.name,abstract:r.description,thumbnail_url:r.thumbnail,data:m};return e?(0,S.sA)(e,_(_({},O),{},{id:e})):(0,S.df)(O).then((function(t){if(n){var e=((0,p.u8)("geoNodeSettings")||{}).geonodeUrl,r=void 0===e?"/":e;window.location.href=(0,h.zL)("".concat(r,"catalogue/#/map/").concat(t.pk)),window.location.reload()}return t.data}))})),N(n,A.P6.GEOSTORY,(function(t,e,r,n){var o=(0,b.Kg)(t),u=(0,v.np)(t),i={title:r.name,abstract:r.description,thumbnail_url:r.thumbnail,data:o};return e?(0,S.yp)(e,i):(0,S.Du)(_({name:r.name+" "+w()(),owner:u.name,resource_type:A.P6.GEOSTORY},i)).then((function(t){if(n){var e=((0,p.u8)("geoNodeSettings")||{}).geonodeUrl,r=void 0===e?"/":e;window.location.href=(0,h.zL)("".concat(r,"catalogue/#/geostory/").concat(t.pk)),window.location.reload()}return t.data}))})),N(n,A.P6.DASHBOARD,(function(t,e,r,n){var o=(0,y.md)(t),u=(0,v.np)(t),i={title:r.name,abstract:r.description,thumbnail_url:r.thumbnail,data:o};return e?(0,S.yp)(e,i):(0,S.Du)(_({name:r.name+" "+w()(),owner:u.name,resource_type:A.P6.DASHBOARD},i)).then((function(t){if(n){var e=((0,p.u8)("geoNodeSettings")||{}).geonodeUrl,r=void 0===e?"/":e;window.location.href=(0,h.zL)("".concat(r,"catalogue/#/dashboard/").concat(t.pk)),window.location.reload()}return t.data}))})),N(n,A.P6.DOCUMENT,(function(t,e,r){var n={title:r.name,abstract:r.description,thumbnail_url:r.thumbnail};return!!e&&(0,S.gU)(e,n)})),N(n,A.P6.DATASET,(function(t,e,r){var n={title:r.name,abstract:r.description,thumbnail_url:r.thumbnail};return!!e&&(0,S.do)(e,n)})),n);const U={gnSaveContent:function(t,e){return t.ofType(m.oG).switchMap((function(t){var r,n=e.getState(),o=(null===(r=n.gnresource)||void 0===r?void 0:r.type)||"map";return i.Observable.defer((function(){return M[o](n,t.id,t.metadata,t.reload)})).switchMap((function(e){return i.Observable.of.apply(i.Observable,[(0,m.gc)(e),(0,O.QN)({title:t.metadata.name,abstract:t.metadata.description,thumbnail_url:t.metadata.thumbnail,extension:null==e?void 0:e.extension,href:null==e?void 0:e.href})].concat(C(t.showNotifications?[(0,g.Vp)({title:"saveDialog.saveSuccessTitle",message:"saveDialog.saveSuccessMessage"})]:[])))})).catch((function(e){return i.Observable.of.apply(i.Observable,[(0,m.cE)(e.data||e.message)].concat(C(t.showNotifications?[(0,g.vU)({title:"map.mapError.errorTitle",message:"map.mapError.errorDefault"})]:[])))})).startWith((0,m.id)())}))},gnUpdateResource:function(t,e){return t.ofType(m.XG).switchMap((function(t){var r,n=(null===(r=e.getState().gnresource)||void 0===r?void 0:r.data)||{};return!t.id||n.pk&&t.id&&n.pk+""==t.id+""?i.Observable.empty():i.Observable.defer((function(){return(0,S.iv)(t.id)})).switchMap((function(t){return i.Observable.of((0,O.DF)(t))})).catch((function(t){return i.Observable.of((0,O.mN)(t.data||t.message))})).startWith((0,O.Q$)())}))},gnSaveDirectContent:function(t,e){return t.ofType(m.oz).switchMap((function(){var t=e.getState(),r=(0,c._H)(t),n=(null==r?void 0:r.id)||(0,D.fg)(t),o=(0,D.oS)(t),a=o.compactPermissions,s=o.geoLimits,l=(0,D.yK)(t);return i.Observable.concat.apply(i.Observable,C(a?[i.Observable.defer((function(){return(0,S.BY)(n,(0,A.go)(a)).then((function(t){return{resource:l,output:t,processType:I.zj.PERMISSIONS_RESOURCE}})).catch((function(t){var e;return{resource:l,error:(null==t||null===(e=t.data)||void 0===e?void 0:e.detail)||(null==t?void 0:t.statusText)||(null==t?void 0:t.message)||!0,processType:I.zj.PERMISSIONS_RESOURCE}}))})).switchMap((function(t){return i.Observable.of((0,j.tv)(t))}))]:[]).concat([i.Observable.defer((function(){return u().all([(0,S.iv)(n)].concat(C(s?s.map((function(t){return 0===t.features.length?(0,P.jg)(n,t.id,t.type).catch((function(){return null})):(0,P.dl)(n,t.id,t.type,{features:t.features}).catch((function(){return null}))})):[])))})).switchMap((function(e){var r,o,u=(r=e,o=1,function(t){if(Array.isArray(t))return t}(r)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,u=[],i=!0,c=!1;try{for(r=r.call(t);!(i=(n=r.next()).done)&&(u.push(n.value),!e||u.length!==e);i=!0);}catch(t){c=!0,o=t}finally{try{i||null==r.return||r.return()}finally{if(c)throw o}}return u}}(r,o)||R(r,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],c=(0,D.Yj)(t),a=(0,D.uu)(t),s=(0,D.UU)(t),l={name:c||(null==u?void 0:u.title),description:a||(null==u?void 0:u.abstract),thumbnail:s||(null==u?void 0:u.thumbnail_url),extension:null==u?void 0:u.extension,href:null==u?void 0:u.href};return i.Observable.of((0,O.DF)(u),(0,m.Vj)(n,l,!1,!0),(0,O.F4)())}))])).catch((function(t){var e;return i.Observable.of((0,m.cE)(t.data||t.message),(0,g.vU)({title:"map.mapError.errorTitle",message:(null==t||null===(e=t.data)||void 0===e?void 0:e.detail)||(null==t?void 0:t.message)||"map.mapError.errorDefault"}))})).startWith((0,m.id)())}))}}},62170:(t,e,r)=>{"use strict";r.d(e,{Z:()=>i});var n=r(73443),o=r(43892),u={};const i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case o.$X:return u;case n.rs:case n.oz:return{saving:!0,error:void 0,success:void 0};case n.AY:return{success:e.success,saving:!1};case n.SW:return{error:e.error,saving:!1};case n.yB:return{};default:return t}}}}]);