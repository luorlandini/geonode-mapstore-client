(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[8321],{31935:(e,t,r)=>{"use strict";r.d(t,{YL:()=>c,B0:()=>u,Mz:()=>l,TC:()=>s,qS:()=>f,Pe:()=>d,TP:()=>b});var n=r(22222),o=r(75110),a=r(93152),i=r(24262),c=function(e){return e.backgroundSelector&&e.backgroundSelector.source},u=function(e){return e.backgroundSelector&&e.backgroundSelector.modalParams},l=function(e){return e.backgroundSelector&&e.backgroundSelector.backgrounds||[]},s=function(e){return e.backgroundSelector&&e.backgroundSelector.lastRemovedId},f=function(e){return e.backgroundSelector&&e.backgroundSelector.confirmDeleteBackgroundModal},d=function(e){return e.backgroundSelector&&e.backgroundSelector.allowDeletion},b=(0,n.P1)(o.l2,a.$v,a.lh,(function(e,t,r){var n=e.filter((function(e){return e&&"background"===e.group}));return r&&r[t]?n.map((function(e){return(0,i.kf)(e,t)}))||[]:n}))},58422:(e,t,r)=>{"use strict";r.d(t,{UC:()=>p}),r(52259),r(827);var n=r(22222),o=r(88113),a=r(1757),i=r(7877),c=r(85148),u=r(97291);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r(75110),r(31935);var d={},b=(0,n.zB)({catalogServices:(0,n.zB)({services:o.b6,selectedService:o.Cb}),widgetsConfig:(0,n.zB)({widgets:a.zm,layouts:a.p,collapsed:a.lF}),mapInfoConfiguration:i.bI,dimensionData:(0,n.zB)({currentTime:c.WT,offsetTime:c.ns}),timelineData:(0,n.zB)({selectedLayer:u.Li})}),p=function(e){var t=Object.keys(d).reduce((function(t,r){return s(s({},t),{},f({},r,d[r](e)))}),{});return s(s({},b(e)),t)}},87218:(e,t,r)=>{"use strict";r.d(t,{I:()=>n,_:()=>o});var n=function(e){return e.searchconfig&&e.searchconfig.textSearchConfig},o=function(e){return e.searchbookmarkconfig&&e.searchbookmarkconfig.bookmarkSearchConfig}},74621:(e,t,r)=>{"use strict";r.d(t,{np:()=>n,L3:()=>o,jl:()=>a,y8:()=>i,qg:()=>c}),r(27418),r(27361);var n=function(e){return e&&e.security&&e.security.user},o=function(e){return n(e)&&n(e).role},a=function(e){return e&&e.security&&e.security.user},i=function(e){return e.security&&e.security.token},c=function(e){return"ADMIN"===o(e)}},73443:(e,t,r)=>{"use strict";r.d(t,{rs:()=>n,AY:()=>o,SW:()=>a,yB:()=>i,oG:()=>c,XG:()=>u,oz:()=>l,id:()=>s,gc:()=>f,cE:()=>d,rG:()=>b,Vj:()=>p,Pg:()=>v,nY:()=>g});var n="GEONODE:SAVING_RESOURCE",o="GEONODE:SAVE_SUCCESS",a="GEONODE:SAVE_ERROR",i="GEONODE:CLEAR_SAVE",c="GEONODE:SAVE_CONTENT",u="GEONODE:UPDATE_RESOURCE_BEFORE_SAVE",l="GEONODE:SAVE_DIRECT_CONTENT";function s(){return{type:n}}function f(e){return{type:o,success:e}}function d(e){return{type:a,error:e}}function b(){return{type:i}}function p(e,t,r,n){return{type:c,id:e,metadata:t,reload:r,showNotifications:n}}function v(e){return{type:u,id:e}}function g(){return{type:l}}},18576:(e,t,r)=>{"use strict";r.d(t,{ZP:()=>M});var n,o=r(75875),a=r.n(o),i=r(49977),c=r(827),u=r(75110),l=r(31935),s=r(58422),f=r(87218),d=r(52259),b=r(63202),p=r(66113),v=r(1757),g=r(74621),m=r(97395),y=r(73443),O=r(43892),h=r(99380),S=r(55035),w=r(55877),E=r.n(w),D=r(3828),k=r(89514),j=r(35721);function P(e){return function(e){if(Array.isArray(e))return _(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||A(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){if(e){if("string"==typeof e)return _(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_(e,t):void 0}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){N(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function N(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var U=(N(n={},j.P6.MAP,(function(e,t,r,n){var o=(0,c.Od)(e)||{},a=(0,u.l2)(e),i=(0,u.Bt)(e),p=(0,l.Mz)(e),v=(0,f.I)(e),g=(0,f._)(e),m=(0,s.UC)(e),y=(0,d.saveMapConfiguration)(o,a,i,p,v,g,m),O={title:r.name,abstract:r.description,thumbnail_url:r.thumbnail,data:y};return t?(0,h.sA)(t,C(C({},O),{},{id:t})):(0,h.df)(O).then((function(e){if(n){var t=((0,b.u8)("geoNodeSettings")||{}).geonodeUrl,r=void 0===t?"/":t;window.location.href=(0,S.zL)("".concat(r,"catalogue/#/map/").concat(e.pk)),window.location.reload()}return e.data}))})),N(n,j.P6.GEOSTORY,(function(e,t,r,n){var o=(0,p.Kg)(e),a=(0,g.np)(e),i={title:r.name,abstract:r.description,thumbnail_url:r.thumbnail,data:o};return t?(0,h.yp)(t,i):(0,h.Du)(C({name:r.name+" "+E()(),owner:a.name,resource_type:j.P6.GEOSTORY},i)).then((function(e){if(n){var t=((0,b.u8)("geoNodeSettings")||{}).geonodeUrl,r=void 0===t?"/":t;window.location.href=(0,S.zL)("".concat(r,"catalogue/#/geostory/").concat(e.pk)),window.location.reload()}return e.data}))})),N(n,j.P6.DASHBOARD,(function(e,t,r,n){var o=(0,v.md)(e),a=(0,g.np)(e),i={title:r.name,abstract:r.description,thumbnail_url:r.thumbnail,data:o};return t?(0,h.yp)(t,i):(0,h.Du)(C({name:r.name+" "+E()(),owner:a.name,resource_type:j.P6.DASHBOARD},i)).then((function(e){if(n){var t=((0,b.u8)("geoNodeSettings")||{}).geonodeUrl,r=void 0===t?"/":t;window.location.href=(0,S.zL)("".concat(r,"catalogue/#/dashboard/").concat(e.pk)),window.location.reload()}return e.data}))})),N(n,j.P6.DOCUMENT,(function(e,t,r){var n={title:r.name,abstract:r.description,thumbnail_url:r.thumbnail};return!!t&&(0,h.gU)(t,n)})),N(n,j.P6.DATASET,(function(e,t,r){var n={title:r.name,abstract:r.description,thumbnail_url:r.thumbnail};return!!t&&(0,h.do)(t,n)})),n);const M={gnSaveContent:function(e,t){return e.ofType(y.oG).switchMap((function(e){var r,n=t.getState(),o=(null===(r=n.gnresource)||void 0===r?void 0:r.type)||"map";return i.Observable.defer((function(){return U[o](n,e.id,e.metadata,e.reload)})).switchMap((function(t){return i.Observable.of.apply(i.Observable,[(0,y.gc)(t),(0,O.QN)({title:e.metadata.name,abstract:e.metadata.description,thumbnail_url:e.metadata.thumbnail,extension:null==t?void 0:t.extension,href:null==t?void 0:t.href})].concat(P(e.showNotifications?[(0,m.Vp)({title:"saveDialog.saveSuccessTitle",message:"saveDialog.saveSuccessMessage"})]:[])))})).catch((function(t){return i.Observable.of.apply(i.Observable,[(0,y.cE)(t.data||t.message)].concat(P(e.showNotifications?[(0,m.vU)({title:"map.mapError.errorTitle",message:"map.mapError.errorDefault"})]:[])))})).startWith((0,y.id)())}))},gnUpdateResource:function(e,t){return e.ofType(y.XG).switchMap((function(e){var r,n=(null===(r=t.getState().gnresource)||void 0===r?void 0:r.data)||{};return!e.id||n.pk&&e.id&&n.pk+""==e.id+""?i.Observable.empty():i.Observable.defer((function(){return(0,h.iv)(e.id)})).switchMap((function(e){return i.Observable.of((0,O.DF)(e))})).catch((function(e){return i.Observable.of((0,O.mN)(e.data||e.message))})).startWith((0,O.Q$)())}))},gnSaveDirectContent:function(e,t){return e.ofType(y.oz).switchMap((function(){var e,r=t.getState(),n=(0,c._H)(r),o=(null==n?void 0:n.id)||(null==r||null===(e=r.gnresource)||void 0===e?void 0:e.id),u=(0,D.oS)(r),l=u.compactPermissions,s=u.geoLimits;return i.Observable.concat.apply(i.Observable,P(l?[i.Observable.defer((function(){return(0,h.BY)(o,(0,j.go)(l))})).switchMap((function(){return i.Observable.empty()}))]:[]).concat([i.Observable.defer((function(){return a().all([(0,h.iv)(o)].concat(P(s?s.map((function(e){return 0===e.features.length?(0,k.jg)(o,e.id,e.type).catch((function(){return null})):(0,k.dl)(o,e.id,e.type,{features:e.features}).catch((function(){return null}))})):[])))})).switchMap((function(e){var t,n,a=(t=e,n=1,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,c=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){c=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(c)throw o}}return a}}(t,n)||A(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],c=(0,D.Yj)(r),u=(0,D.uu)(r),l=(0,D.UU)(r),s={name:c||(null==a?void 0:a.title),description:u||(null==a?void 0:a.abstract),thumbnail:l||(null==a?void 0:a.thumbnail_url),extension:null==a?void 0:a.extension,href:null==a?void 0:a.href};return i.Observable.of((0,O.DF)(a),(0,y.Vj)(o,s,!1,!0),(0,O.F4)())}))])).catch((function(e){var t;return i.Observable.of((0,y.cE)(e.data||e.message),(0,m.vU)({title:"map.mapError.errorTitle",message:(null==e||null===(t=e.data)||void 0===t?void 0:t.detail)||(null==e?void 0:e.message)||"map.mapError.errorDefault"}))})).startWith((0,y.id)())}))}}},62170:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(73443),o=r(43892),a={};const i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case o.$X:return a;case n.rs:case n.oz:return{saving:!0,error:void 0,success:void 0};case n.AY:return{success:t.success,saving:!1};case n.SW:return{error:t.error,saving:!1};case n.yB:return{};default:return e}}}}]);